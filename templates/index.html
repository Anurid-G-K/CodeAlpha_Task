<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Polyglot Portal</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<style>
body {
  background-color: #000000;
  color: #d4ffd4;
  font-family: 'Segoe UI', sans-serif;
  height: 100vh;
  overflow: hidden;
}

.translator-container {
  max-width: 800px;
  margin: 20px auto;
  background-color: #1b1b1b;
  padding: 20px;
  border-radius: 16px;
  box-shadow: 0 0 20px rgba(57, 255, 20, 0.3);
  height: calc(100vh - 40px);
  display: flex;
  flex-direction: column;
}

h1, h5 {
  color: #2fff00;
  text-align: center;
  margin: 0;
}

h2.subtitle {
  font-size: 1rem;
  color: white;
  text-align: center;
  margin-bottom: 30px;
  margin-top: 20px;
}

label {
  color: #aaffaa;
  font-size: 0.9rem;
}

textarea.form-control,
select.form-select {
  background-color: #2b2b2b;
  color: #ffffff;
  border: 1px solid #4caf50;
  font-size: 0.9rem;
}

textarea.form-control:focus {
  background-color: #2b2b2b;
  color: #ffffff;
  border-color: #4caf50;
  box-shadow: 0 0 0 0.25rem rgba(76, 175, 80, 0.25);
}

.form-control::placeholder {
  color: #88ff88;
}

.btn-translate {
  background-color: #39FF14;
  border: none;
  color: #000000;
  font-weight: 600;
  padding: 6px 18px;
  font-size: 0.9rem;
  transition: background-color 0.25s ease, color 0.25s ease, transform 0.25s ease;
  transform: scale(1);
}

.btn-translate:hover {
  background-color: #40ffe2;
  color: #000000;
  transform: scale(1.08);
}

.copy-btn {
  position: absolute;
  right: 10px;
  top: 10px;
  font-size: 0.85rem;
  padding: 3px 10px;
  background-color: transparent;
  border: 1px solid #39FF14;
  color: #39FF14;
  transition: 0.3s ease-in-out;
}

.copy-btn:hover {
  background-color: #39FF14;
  color: #000;
}

.position-relative textarea {
  padding-right: 60px;
}

.alert {
  background-color: #1f1f1f;
  color: #39FF14;
  border-left: 4px solid #39FF14;
  font-size: 0.9rem;
  padding: 0.5rem;
}

.error-alert {
  color: #ff6b6b;
  border-left: 4px solid #ff6b6b;
}

.text-danger {
  color: #ff6b6b !important;
}

.char-limit-warning {
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { opacity: 1; }
  50% { opacity: 0.6; }
  100% { opacity: 1; }
}

.text-boxes {
  display: flex;
  gap: 10px;
  margin-bottom: 30px;
  height: calc(100% - 200px);
}

.text-box {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.text-box textarea {
  flex-grow: 1;
  resize: none;
}

.language-selector {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 30px;
}

.language-selector-col {
  flex: 1;
}

.swap-btn {
  background-color: transparent;
  border: 1px solid #39FF14;
  color: #39FF14;
  border-radius: 50%;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  margin-top: 24px;
}

.swap-btn:hover {
  background-color: #39FF14;
  color: #000;
}

/* Select2 customization */
.select2-container--bootstrap-5 {
  width: 100% !important;
}

.select2-container--bootstrap-5 .select2-selection {
  background-color: #2b2b2b;
  color: #ffffff;
  border: 1px solid #4caf50;
  height: auto;
  padding: 0.375rem 0.75rem;
  font-size: 0.9rem;
}

.select2-container--bootstrap-5 .select2-selection--single .select2-selection__rendered {
  color: #ffffff;
  padding-left: 0;
}

.select2-container--bootstrap-5 .select2-selection--single .select2-selection__arrow {
  height: 100%;
}

.select2-container--bootstrap-5 .select2-dropdown {
  background-color: #2b2b2b;
  border: 1px solid #4caf50;
}

.select2-container--bootstrap-5 .select2-search--dropdown .select2-search__field {
  background-color: #2b2b2b;
  color: #ffffff;
  border: 1px solid #4caf50;
  outline: none;
}

.select2-container--bootstrap-5 .select2-results__option {
  color: #ffffff;
  padding: 0.5rem 1rem;
  font-size: 0.9rem;
}

.select2-container--bootstrap-5 .select2-results__option--highlighted {
  background-color: #39FF14;
  color: #000000;
}

.select2-container--bootstrap-5 .select2-selection--single .select2-selection__placeholder {
  color: #88ff88;
}

.select2-container--bootstrap-5 .select2-selection--single .select2-selection__search {
  width: 100%;
}

.select2-container--bootstrap-5 .select2-selection--single .select2-selection__search input {
  width: 100% !important;
  background-color: transparent;
  color: #ffffff;
  border: none;
  outline: none;
  box-shadow: none;
}

.select2-container--bootstrap-5.select2-container--focus .select2-selection,
.select2-container--bootstrap-5.select2-container--open .select2-selection {
  border-color: #4caf50;
  box-shadow: 0 0 0 0.25rem rgba(76, 175, 80, 0.25);
}
</style>
</head>
<body>

<div class="translator-container">
  <h1>Polyglot Portal</h1>
  <h2 class="subtitle">A Language Translator App</h2>

  <form method="POST" action="/" onsubmit="return validateForm()">
    <div class="language-selector">
      <div class="language-selector-col">
        <label for="source_lang" class="form-label">Source Language:</label>
        <select class="form-select select2" name="source_lang" id="source_lang" required>
          <option value="af">Afrikaans</option>
<option value="sq">Albanian</option>
<option value="ar">Arabic</option>
<option value="hy">Armenian</option>
<option value="az">Azerbaijani</option>
<option value="eu">Basque</option>
<option value="be">Belarusian</option>
<option value="bn">Bengali</option>
<option value="bs">Bosnian</option>
<option value="bg">Bulgarian</option>
<option value="ca">Catalan</option>
<option value="ceb">Cebuano</option>
<option value="zh">Chinese</option>
<option value="hr">Croatian</option>
<option value="cs">Czech</option>
<option value="da">Danish</option>
<option value="nl">Dutch</option>
<option value="en" selected>English</option>
<option value="eo">Esperanto</option>
<option value="et">Estonian</option>
<option value="tl">Filipino</option>
<option value="fi">Finnish</option>
<option value="fr">French</option>
<option value="fy">Frisian</option>
<option value="gl">Galician</option>
<option value="ka">Georgian</option>
<option value="de">German</option>
<option value="el">Greek</option>
<option value="gu">Gujarati</option>
<option value="ht">Haitian Creole</option>
<option value="ha">Hausa</option>
<option value="haw">Hawaiian</option>
<option value="he">Hebrew</option>
<option value="hi">Hindi</option>
<option value="hmn">Hmong</option>
<option value="hu">Hungarian</option>
<option value="is">Icelandic</option>
<option value="ig">Igbo</option>
<option value="id">Indonesian</option>
<option value="ga">Irish</option>
<option value="it">Italian</option>
<option value="ja">Japanese</option>
<option value="jw">Javanese</option>
<option value="kn">Kannada</option>
<option value="kk">Kazakh</option>
<option value="km">Khmer</option>
<option value="ko">Korean</option>
<option value="ku">Kurdish</option>
<option value="ky">Kyrgyz</option>
<option value="lo">Lao</option>
<option value="la">Latin</option>
<option value="lv">Latvian</option>
<option value="lt">Lithuanian</option>
<option value="lb">Luxembourgish</option>
<option value="mk">Macedonian</option>
<option value="mg">Malagasy</option>
<option value="ms">Malay</option>
<option value="ml">Malayalam</option>
<option value="mt">Maltese</option>
<option value="mi">Maori</option>
<option value="mr">Marathi</option>
<option value="mn">Mongolian</option>
<option value="my">Myanmar (Burmese)</option>
<option value="ne">Nepali</option>
<option value="no">Norwegian</option>
<option value="ny">Nyanja (Chichewa)</option>
<option value="ps">Pashto</option>
<option value="fa">Persian</option>
<option value="pl">Polish</option>
<option value="pt">Portuguese</option>
<option value="pa">Punjabi</option>
<option value="ro">Romanian</option>
<option value="ru">Russian</option>
<option value="sm">Samoan</option>
<option value="gd">Scots Gaelic</option>
<option value="sr">Serbian</option>
<option value="st">Sesotho</option>
<option value="sn">Shona</option>
<option value="sd">Sindhi</option>
<option value="si">Sinhala</option>
<option value="sk">Slovak</option>
<option value="sl">Slovenian</option>
<option value="so">Somali</option>
<option value="es">Spanish</option>
<option value="su">Sundanese</option>
<option value="sw">Swahili</option>
<option value="sv">Swedish</option>
<option value="tg">Tajik</option>
<option value="ta">Tamil</option>
<option value="te">Telugu</option>
<option value="th">Thai</option>
<option value="tr">Turkish</option>
<option value="uk">Ukrainian</option>
<option value="ur">Urdu</option>
<option value="uz">Uzbek</option>
<option value="vi">Vietnamese</option>
<option value="cy">Welsh</option>
<option value="xh">Xhosa</option>
<option value="yi">Yiddish</option>
<option value="yo">Yoruba</option>
<option value="zu">Zulu</option>
        </select>
      </div>
      
      <button type="button" class="swap-btn" id="swapLanguages">
        <i class="fas fa-exchange-alt"></i>
      </button>
      
      <div class="language-selector-col">
        <label for="target_lang" class="form-label">Target Language:</label>
        <select class="form-select select2" name="target_lang" id="target_lang" required>
          <option value="af">Afrikaans</option>
<option value="sq">Albanian</option>
<option value="ar">Arabic</option>
<option value="hy">Armenian</option>
<option value="az">Azerbaijani</option>
<option value="eu">Basque</option>
<option value="be">Belarusian</option>
<option value="bn">Bengali</option>
<option value="bs">Bosnian</option>
<option value="bg">Bulgarian</option>
<option value="ca">Catalan</option>
<option value="ceb">Cebuano</option>
<option value="zh">Chinese</option>
<option value="hr">Croatian</option>
<option value="cs">Czech</option>
<option value="da">Danish</option>
<option value="nl">Dutch</option>
<option value="en" selected>English</option>
<option value="eo">Esperanto</option>
<option value="et">Estonian</option>
<option value="tl">Filipino</option>
<option value="fi">Finnish</option>
<option value="fr">French</option>
<option value="fy">Frisian</option>
<option value="gl">Galician</option>
<option value="ka">Georgian</option>
<option value="de">German</option>
<option value="el">Greek</option>
<option value="gu">Gujarati</option>
<option value="ht">Haitian Creole</option>
<option value="ha">Hausa</option>
<option value="haw">Hawaiian</option>
<option value="he">Hebrew</option>
<option value="hi">Hindi</option>
<option value="hmn">Hmong</option>
<option value="hu">Hungarian</option>
<option value="is">Icelandic</option>
<option value="ig">Igbo</option>
<option value="id">Indonesian</option>
<option value="ga">Irish</option>
<option value="it">Italian</option>
<option value="ja">Japanese</option>
<option value="jw">Javanese</option>
<option value="kn">Kannada</option>
<option value="kk">Kazakh</option>
<option value="km">Khmer</option>
<option value="ko">Korean</option>
<option value="ku">Kurdish</option>
<option value="ky">Kyrgyz</option>
<option value="lo">Lao</option>
<option value="la">Latin</option>
<option value="lv">Latvian</option>
<option value="lt">Lithuanian</option>
<option value="lb">Luxembourgish</option>
<option value="mk">Macedonian</option>
<option value="mg">Malagasy</option>
<option value="ms">Malay</option>
<option value="ml">Malayalam</option>
<option value="mt">Maltese</option>
<option value="mi">Maori</option>
<option value="mr">Marathi</option>
<option value="mn">Mongolian</option>
<option value="my">Myanmar (Burmese)</option>
<option value="ne">Nepali</option>
<option value="no">Norwegian</option>
<option value="ny">Nyanja (Chichewa)</option>
<option value="ps">Pashto</option>
<option value="fa">Persian</option>
<option value="pl">Polish</option>
<option value="pt">Portuguese</option>
<option value="pa">Punjabi</option>
<option value="ro">Romanian</option>
<option value="ru">Russian</option>
<option value="sm">Samoan</option>
<option value="gd">Scots Gaelic</option>
<option value="sr">Serbian</option>
<option value="st">Sesotho</option>
<option value="sn">Shona</option>
<option value="sd">Sindhi</option>
<option value="si">Sinhala</option>
<option value="sk">Slovak</option>
<option value="sl">Slovenian</option>
<option value="so">Somali</option>
<option value="es">Spanish</option>
<option value="su">Sundanese</option>
<option value="sw">Swahili</option>
<option value="sv">Swedish</option>
<option value="tg">Tajik</option>
<option value="ta">Tamil</option>
<option value="te">Telugu</option>
<option value="th">Thai</option>
<option value="tr">Turkish</option>
<option value="uk">Ukrainian</option>
<option value="ur">Urdu</option>
<option value="uz">Uzbek</option>
<option value="vi">Vietnamese</option>
<option value="cy">Welsh</option>
<option value="xh">Xhosa</option>
<option value="yi">Yiddish</option>
<option value="yo">Yoruba</option>
<option value="zu">Zulu</option>
        </select>
      </div>
    </div>

    <div class="text-boxes">
      <div class="text-box">
        <label for="input_text" class="form-label">Source Text:</label>
        <div class="position-relative">
          <textarea class="form-control" name="input_text" id="input_text" rows="6" 
                    required placeholder="Type text here..." maxlength="500">{{ input_text if input_text else '' }}</textarea>
        </div>
        <div class="mb-1 text-end">
          <small class="text-muted">
            <span id="charCounter">{{ input_text|length if input_text else 0 }}</span>/500 characters
            <span id="charWarning" class="char-limit-warning text-danger" style="display:none;">
              ⚠️ MyMemory limits to 500 characters
            </span>
          </small>
        </div>
      </div>

      <div class="text-box">
        <label for="translated_output" class="form-label">Translated Output:</label>
        <div class="position-relative">
          <textarea class="form-control" id="translated_output" rows="6" readonly>{{ translated if translated else '' }}</textarea>
          <button class="btn btn-outline-info copy-btn" onclick="copyText()">Copy</button>
        </div>
      </div>
    </div>

    <div class="text-center mt-2">
      <button type="submit" class="btn btn-translate">Translate</button>
    </div>
  </form>

  {% if translated %}
    {% if translated.startswith("Translation error:") or translated.startswith("Server Error:") %}
      <div class="alert error-alert mt-2">
        {{ translated }}
      </div>
    {% endif %}
  {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script>
  // Initialize Select2 for language dropdowns with inline search
  $(document).ready(function() {
    $('.select2').select2({
      theme: 'bootstrap-5',
      width: '100%',
      placeholder: 'Select a language',
      allowClear: false,
      minimumResultsForSearch: 1
    });

    // Get stored language selections from localStorage
    const storedSourceLang = localStorage.getItem('sourceLang') || 'en';
    const storedTargetLang = localStorage.getItem('targetLang') || 'es';
    
    // Set the selected values
    $('#source_lang').val(storedSourceLang).trigger('change');
    $('#target_lang').val(storedTargetLang).trigger('change');

    // Store selections when changed
    $('#source_lang').on('change', function() {
      localStorage.setItem('sourceLang', $(this).val());
    });
    
    $('#target_lang').on('change', function() {
      localStorage.setItem('targetLang', $(this).val());
    });
  });

  // Language swap functionality
  document.getElementById('swapLanguages').addEventListener('click', function() {
    const sourceLang = $('#source_lang').val();
    const targetLang = $('#target_lang').val();
    
    $('#source_lang').val(targetLang).trigger('change');
    $('#target_lang').val(sourceLang).trigger('change');
    
    // Also swap the text areas if they have content
    const inputText = $('#input_text').val();
    const outputText = $('#translated_output').val();
    
    if (outputText) {
      $('#input_text').val(outputText);
      $('#translated_output').val(inputText);
      
      // Update character counter
      const length = outputText.length;
      charCounter.textContent = length;
      if (length > 500) {
        charCounter.classList.add('text-danger');
        charWarning.style.display = 'inline';
      } else {
        charCounter.classList.remove('text-danger');
        charWarning.style.display = 'none';
      }
    }
    
    // Update localStorage
    localStorage.setItem('sourceLang', targetLang);
    localStorage.setItem('targetLang', sourceLang);
  });

  // Character counter with warning
  const inputText = document.getElementById('input_text');
  const charCounter = document.getElementById('charCounter');
  const charWarning = document.getElementById('charWarning');

  inputText.addEventListener('input', function() {
    const length = this.value.length;
    charCounter.textContent = length;
    
    if (length > 500) {
      charCounter.classList.add('text-danger');
      charWarning.style.display = 'inline';
    } else {
      charCounter.classList.remove('text-danger');
      charWarning.style.display = 'none';
    }
  });

  // Form validation
  function validateForm() {
    if (inputText.value.length > 500) {
      alert("MyMemory API limits translations to 500 characters. Please shorten your text.");
      return false;
    }
    return true;
  }

  // Enhanced copy function
  function copyText() {
    const output = document.getElementById("translated_output");
    output.select();
    output.setSelectionRange(0, 99999);
    
    try {
      document.execCommand("copy");
      showNotification('Copied to clipboard!', '#39FF14');
    } catch (err) {
      showNotification('Failed to copy!', '#ff6b6b');
    }
  }

  function showNotification(message, color) {
    const notification = document.createElement('div');
    notification.style.position = 'fixed';
    notification.style.bottom = '20px';
    notification.style.right = '20px';
    notification.style.backgroundColor = color;
    notification.style.color = '#000';
    notification.style.padding = '12px 24px';
    notification.style.borderRadius = '5px';
    notification.style.zIndex = '1000';
    notification.style.boxShadow = '0 0 15px rgba(0,0,0,0.3)';
    notification.style.fontWeight = '600';
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.opacity = '0';
      notification.style.transition = 'opacity 0.5s';
      setTimeout(() => document.body.removeChild(notification), 500);
    }, 2000);
  }
</script>

</body>
</html>